<?php
/**
 * Created by SpamTrawler.
 * User: griddie
 * Date: 16/06/14
 * Time: 12:15
 * Copyright (c) 2014 Oliver Putzer (SpamTrawler)
 */
class Filesystem_Malwarescanner_Model_Scanner
{
    private $oTableNotifications = null;

    public function __construct(){
        $this->oTableNotifications = new SpamTrawler_Db_Tables_Generic('notifications');
    }

    public function scan($aScanOptions){
        $scanPath = $_SERVER['DOCUMENT_ROOT'];

        //end advanced scan options
        exec("/usr/local/maldetect/maldet --scan-all $scanPath", $output);

        $mailMessage = '';
        $content = '';
        $mailMessage .= 'Path: '.$scanPath . "\r\n";
        foreach ($output as $key => $value) {
            $mailMessage .= "\r\n".$value."\r\n";
            $content .= $value. '<br />';
        }

        $oNotifications = new Admin_Notifications_Model_Manage();
        $oNotifications->add('Malwarescan', str_replace('<br />', "\r\n", $content));
    }

    public function validate(){}
}